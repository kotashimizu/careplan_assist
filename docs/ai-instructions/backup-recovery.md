# バックアップ・復旧ルール

## 基本方針
非エンジニアが安心して開発できるよう、重要なタイミングで自動バックアップを実行する。

## バックアップの保存先
```
project-root/
├── .backups/
│   ├── daily/          # 日次バックアップ
│   ├── before-major/   # 重要変更前
│   └── snapshots/      # スナップショット
```

## 自動バックアップタイミング

### 1. 重要変更前の必須バックアップ
- 大きな機能追加・変更前
- デザイン全体変更前
- データベース変更前
- 複数ファイル同時変更前

### 2. 定期バックアップ
- 1日1回（作業終了時）
- 重要機能完成時
- ユーザー要求時

### 3. 緊急バックアップ
- エラー発生直前の正常状態
- 重大な問題発生前

## バックアップ保持期間
- GitHubを使用：無制限
- ローカルのみ：1ヶ月分が目安

## 復旧支援

### 簡単な復旧指示
```
ユーザー: 「2時間前に戻してください」
AI: 「2時間前のバックアップから復旧します。以下の変更が取り消されます：[詳細]」
```

### 復旧前の確認項目
- 復旧ポイントの明示
- 失われる変更の具体的リスト
- 残る機能・失われる機能の明示
- 復旧時間の目安（通常5-10分、最大30分）

## 完成部分の保護ルール

### 基本方針
ユーザーが「これで完成」「これは変更しないで」と明示した部分は絶対に変更しない。

### 保護対象の識別方法

#### 1. 明示的な保護指示
- 「この機能はもう完成なので変更しないでください」
- 「このデザインで確定です」
- 「この部分は触らないで」

#### 2. 保護マーク（HTML/JSX）
```html
<!-- PROTECTED: ユーザー確定済み - 変更禁止 -->
<header class="main-header">
  <!-- 確定したヘッダーデザイン -->
</header>
<!-- /PROTECTED -->
```

#### 3. 保護マーク（JavaScript/TypeScript）
```javascript
// PROTECTED: ユーザー確定済み - 変更禁止
function loginUser(credentials) {
  // 完成したログイン機能
}
// /PROTECTED
```

### 保護対象の記録フォーマット
```
### 完成機能
- ログイン機能（src/components/Auth/Login.jsx）- 2024/XX/XX確定
- TODOリスト機能（src/components/Todo/）- 2024/XX/XX確定

### 確定デザイン
- ヘッダーデザイン（src/components/Header.jsx）- 2024/XX/XX確定
- ダッシュボードレイアウト（src/pages/Dashboard.jsx）- 2024/XX/XX確定

### 保護ファイル
- config/database.js - 設定完了
- public/logo.png - 確定ロゴ
```

### AI動作ルール

#### 1. 変更前の確認必須
- 既存コードを変更する前に必ず「この部分を変更してもよろしいですか？」と確認
- 保護マークがある部分は絶対に変更しない

#### 2. 新機能追加時
- 既存の完成機能に影響しない方法で実装
- 必要なら新しいファイルやコンポーネントを作成

#### 3. デザイン変更時
- 確定済みのレイアウトやスタイルは維持
- 新しいページのみ変更対象とする

### 実行例
```
AI: 「ログイン機能を改善したいのですが、現在のログイン画面のデザインを変更してもよろしいですか？それとも新しい機能として追加しますか？」

ユーザー: 「今のデザインは気に入っているので変更しないで」

AI: 「承知しました。現在のデザインは保護対象として記録し、機能強化は内部処理のみ変更します」
```

### 保護解除ルール

#### 1. 明示的な解除指示
```
「ログイン画面の保護を解除して、デザインを変更してください」
「TODOリスト機能の保護を外して、新しい機能を追加してください」
```

#### 2. 一時的な変更許可
```
「ヘッダーデザインを一時的に変更したいです。完了したら再度保護してください」
```

#### 3. AIの確認プロセス
```
AI: 「保護対象の○○機能を変更されますか？これまでの内容は失われる可能性があります」
ユーザー: 「はい、変更してください」
AI: 「承知しました。保護を解除して変更を開始します」
```