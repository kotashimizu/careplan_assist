# Claude.md — プロジェクト固有の指示

## プロジェクト情報
<!-- ここにプロジェクト固有の情報を記載 -->
- プロジェクト名：AI駆動開発プロジェクトテンプレート
- 主要技術スタック：
  - Next.js 14.0.4 (App Router)
  - React 18.2.0
  - TypeScript 5.3.3
  - Tailwind CSS 3.4.0
  - Supabase 2.38.5 (認証・データベース)
  - Vercel (デプロイ)
- 開発環境：Node.js 18以上

## コーディング規約
<!-- プロジェクト固有のルール -->
- 命名規則：
  - ファイル名：kebab-case（例：user-profile.tsx）
  - コンポーネント：PascalCase（例：UserProfile）
  - 変数・関数：camelCase（例：getUserData）
  - 型定義：PascalCase（例：UserData）
- ディレクトリ構造：
  - src/app/ - App Router用ページ
  - src/components/ - 再利用可能コンポーネント
  - src/lib/ - ユーティリティ・設定
  - src/utils/ - ヘルパー関数
- コメント規約：
  - JSDocを使用
  - 複雑なロジックには日本語コメント

## Git自動化ルール（重要）

### 基本方針
このテンプレートは非エンジニア向けなので、Git操作は全てAIが自動で判断・実行する。

### AI自動コミットルール
1. **機能実装後は必ずコミット**
   - 新機能追加完了時
   - バグ修正完了時
   - 設定ファイル変更時
   - 定期的な進捗保存（30分〜1時間ごと）

2. **ブランチ戦略**
   - 新機能開発時は feature/機能名 ブランチを自動作成
   - バグ修正時は fix/修正内容 ブランチを自動作成
   - 完了後は自動でmainブランチにマージ

3. **コミットメッセージ**
   - 日本語で分かりやすく記述
   - 例：「TODOリスト機能を追加」「ログイン画面のデザインを改善」

4. **自動実行タイミング**
   - ユーザーが「次は何をしますか？」と聞いた時
   - 一区切りついた時点
   - エラー修正後

5. **AIからの能動的提案**
   ユーザーが大きな変更を指示した場合、AIから以下を提案する：
   - 「大きな変更の前に、現在の進捗をコミットしましょうか？」
   - 「新機能開発なので、新しいブランチを作成しますか？」
   - 「複数の変更があるので、段階的にコミットしていきましょうか？」

### 能動的提案の具体例

#### 大きな変更指示を受けた場合
```
ユーザー: 「TODOリストのデザインを全部変えて、カレンダー機能も追加してください」

AI: 「大きな変更になりますね。安全のため以下を提案します：
1. まず現在の進捗をコミットしましょうか？
2. 新機能用のブランチを作成しますか？
3. デザイン変更とカレンダー機能を別々に実装しますか？

どのように進めますか？」
```

#### 複数ファイル変更の場合
```
ユーザー: 「認証システムを追加して、全ページに適用してください」

AI: 「認証システムは重要な機能ですね。以下の手順で安全に実装します：
1. feature/auth ブランチを作成
2. 段階的に実装（ログイン→ページ保護→テスト）
3. 各段階でコミット

この進め方でよろしいですか？」
```

### Git操作実行例
```
# AIが自動で以下を実行：
git checkout -b feature/todo-list
git add .
git commit -m "TODOリスト機能を追加"
git checkout main
git merge feature/todo-list
git push origin main
```

## よく使うコマンド
<!-- プロジェクトでよく使うコマンド -->
```
# 開発サーバー起動
npm run dev

# 型チェック
npm run typecheck

# リント実行
npm run lint

# ビルド
npm run build

# 本番環境起動
npm run start
```

## Vercel & Supabase 設定手順

### Vercelデプロイ手順
1. Vercel CLIインストール：`npm i -g vercel`
2. プロジェクトを初期化：`vercel`
3. 環境変数を設定：`vercel env add`

### Supabase設定手順
1. https://supabase.com でプロジェクト作成
2. Project Settings > API からURL・KEYを取得
3. .env.localファイルを作成して設定
4. 認証設定：Authentication > Settings で設定

## 進捗可視化ルール

### 基本方針
非エンジニアが開発状況を把握しやすいよう、進捗を自動で記録・表示する。

### 自動更新タイミング
1. **機能完成時**
   - PROGRESS.md の完了タスクリストに追加
   - 進捗率を自動計算・更新
   
2. **新しい作業開始時**
   - 進行中タスクに追加
   - 開始時刻を記録

3. **一日の終わり**
   - 「今日の作業記録」を自動生成
   - 明日の予定を提案

### 表示内容
- 視覚的な進捗率（パーセンテージ）
- 完了/進行中/未着手のタスク一覧
- ファイル数、機能数などの統計
- マイルストーン達成状況

### ユーザーへの報告例
```
「TODOリスト機能が完成しました！🎉
📊 現在の進捗: 40% (2/5 機能完了)
✅ 今日完了: ログイン機能、TODOリスト機能
🎯 次回予定: デザイン改善」
```

## エラー解説ルール

### 基本方針
エラーが発生した際は、非エンジニアにも理解できるよう丁寧に解説する。

### エラー対応手順
1. **エラーレベルの判定**
   - 🟢 軽微（自動修正可能）
   - 🟡 中程度（段階的解決）
   - 🔴 重大（詳細プラン必要）

2. **分かりやすい解説**
   ```
   「○○エラーが発生しました。
   
   🔍 何が起きているか: [原因を日本語で説明]
   🛠️ 解決方法: [具体的な手順]
   ⏱️ 解決時間: 約○分程度
   
   一緒に解決していきましょう！」
   ```

3. **ERROR_GUIDE.mdの活用**
   - よくあるエラーは参照して解説
   - 新しいエラーは追記・更新

### 専門用語の扱い
- 英語のエラーメッセージは必ず日本語で解説
- 専門用語は簡単な言葉に置き換え
- 「つまり○○ということです」で補足

### 予防策の提案
- エラー解決後は予防方法も伝える
- 「今度から○○することで防げます」

## バックアップ・復旧ルール

### 基本方針
非エンジニアが安心して開発できるよう、重要なタイミングで自動バックアップを実行する。

### 自動バックアップタイミング
1. **重要変更前の必須バックアップ**
   - 大きな機能追加・変更前
   - デザイン全体変更前
   - データベース変更前
   - 複数ファイル同時変更前

2. **定期バックアップ**
   - 1日1回（作業終了時）
   - 重要機能完成時
   - ユーザー要求時

3. **緊急バックアップ**
   - エラー発生直前の正常状態
   - 重大な問題発生前

### 復旧支援
1. **簡単な復旧指示**
   ```
   ユーザー: 「2時間前に戻してください」
   AI: 「2時間前のバックアップから復旧します。以下の変更が取り消されます：[詳細]」
   ```

2. **復旧前の影響説明**
   - 失われる変更の具体的な説明
   - 残る機能・失われる機能の明示
   - 復旧時間の目安提示

3. **BACKUP_RECOVERY.mdの活用**
   - 復旧手順の参照
   - よくある質問への対応

## 注意事項
<!-- AIが特に注意すべき点 -->
- Git操作は必ずユーザーに説明してから実行
- コミット前に変更内容を簡潔に報告
- エラーが発生した場合はERROR_GUIDE.mdに基づいて分かりやすく説明
- 大きな変更指示を受けた場合は必ず事前にGit提案を行う
- ユーザーが複数の機能を同時に指示した場合は分割を提案
- 進捗状況は常にPROGRESS.mdに記録・更新する
- 重要な変更前は必ずバックアップを提案・実行する

## 完成部分の保護ルール（重要）

### 基本方針
ユーザーが「これで完成」「これは変更しないで」と明示した部分は絶対に変更しない。

### 保護対象の識別方法
1. **明示的な保護指示**
   - 「この機能はもう完成なので変更しないでください」
   - 「このデザインで確定です」
   - 「この部分は触らないで」

2. **保護マーク**
   ```
   <!-- PROTECTED: ユーザー確定済み - 変更禁止 -->
   [保護対象のコード]
   <!-- /PROTECTED -->
   ```

3. **保護ファイルリスト**
   - PROTECTED_FILES.md に記載されたファイルは変更前に必ず確認

### AI動作ルール
1. **変更前の確認必須**
   - 既存コードを変更する前に必ず「この部分を変更してもよろしいですか？」と確認
   - 保護マークがある部分は絶対に変更しない

2. **新機能追加時**
   - 既存の完成機能に影響しない方法で実装
   - 必要なら新しいファイルやコンポーネントを作成

3. **デザイン変更時**
   - 確定済みのレイアウトやスタイルは維持
   - 新しいページのみ変更対象とする

### 実行例
```
AI: 「ログイン機能を改善したいのですが、現在のログイン画面のデザインを変更してもよろしいですか？それとも新しい機能として追加しますか？」

ユーザー: 「今のデザインは気に入っているので変更しないで」

AI: 「承知しました。現在のデザインは保護対象として記録し、機能強化は内部処理のみ変更します」
```

### 保護解除ルール
保護対象を変更したい場合は、以下の手順で解除する：

1. **明示的な解除指示**
   ```
   「ログイン画面の保護を解除して、デザインを変更してください」
   「TODOリスト機能の保護を外して、新しい機能を追加してください」
   ```

2. **一時的な変更許可**
   ```
   「ヘッダーデザインを一時的に変更したいです。完了したら再度保護してください」
   ```

3. **AIの確認プロセス**
   ```
   AI: 「保護対象の○○機能を変更されますか？これまでの内容は失われる可能性があります」
   ユーザー: 「はい、変更してください」
   AI: 「承知しました。保護を解除して変更を開始します」
   ```

## 禁止事項
<!-- 絶対にやってはいけないこと -->
- Gitの複雑なコマンドをユーザーに要求する
- コミットなしで大きな変更を重ねる
- ブランチ切り替えをユーザーに任せる
- 保護マークのあるコードを変更する
- ユーザーの明示的な確認なしに既存の完成機能を変更する
